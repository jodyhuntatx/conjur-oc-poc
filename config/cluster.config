# Configuration settings for demo environment
############################################################
#              Conjur Master Cluster settings
############################################################

#######
# For deploying Conjur in minishift docker daemon
if [[ "$(minishift status | grep Running)" != "" ]]; then
  eval $(minishift oc-env)
  eval $(minishift docker-env)
  export DOCKER_REGISTRY_PATH=$(minishift openshift registry)
fi
export CONJUR_MASTER_HOST_IP=$(minishift ip)
#######

export NO_DNS=true
export CONJUR_MASTER_IN_OC=false
export KUBECONFIGDIR=~/oc-kube
export KUBECONFIG=$KUBECONFIGDIR/config
export CONJUR_MASTER_HOST_NAME=conjur-master
#export CONJUR_MASTER_HOST_IP=192.168.1.199
export CONJUR_ACCOUNT=dev
export CONJUR_ADMIN_PASSWORD=Cyberark1
export CONJUR_APPLIANCE_IMAGE=conjur-appliance:5.3.1
export CLI_IMAGE_NAME=conjurinc/cli5:latest

export CONJUR_MASTER_CONTAINER_NAME=conjur-master
export CONJUR_FOLLOWER_CONTAINER_NAME=conjur-follower
export CLI_CONTAINER_NAME=conjur-cli
export CONJUR_MASTER_PORT=30443
# CONJUR_FOLLOWER_PORT is for follower on master host only - not for OpenShift followers
export CONJUR_FOLLOWER_PORT=30444
export CONJUR_MASTER_PGSYNC_PORT=5432
export CONJUR_MASTER_PGAUDIT_PORT=1999
if $CONJUR_MASTER_IN_OC; then
  export CONJUR_APPLIANCE_URL=https://conjur-master-conjur.192.168.99.100.nip.io
else
  export CONJUR_APPLIANCE_URL=https://$CONJUR_MASTER_HOST_NAME:$CONJUR_MASTER_PORT
fi
export CONJUR_VERSION=5

# location to cache master cert and seed file for Follower configuration
export CACHE_DIR=~/conjur-etc
export CONJUR_CERT_FILE=$CACHE_DIR/conjur-$CONJUR_ACCOUNT.pem
export FOLLOWER_SEED_FILE=$CACHE_DIR/follower-seed.tar

###########################################################
# Cert altnames for Conjur node-to-node TLS authentication
# Alt names must be separated by a spaces, not commas
export CONJUR_NAMESPACE_NAME=conjur

# Alt-names for conjur master cert - master may be on DNS host or in OpenShift
export CONJUR_MASTER_SERVICE_NAME=conjur-master.$CONJUR_NAMESPACE_NAME.svc.cluster.local
export MASTER_ALTNAMES="$CONJUR_MASTER_HOST_NAME,$CONJUR_MASTER_SERVICE_NAME"

# Alt-names for conjur follower cert - followers may run on master host or in OpenShift
export CONJUR_FOLLOWER_SERVICE_NAME=conjur-follower.$CONJUR_NAMESPACE_NAME.svc.cluster.local
export FOLLOWER_ALTNAMES="$CONJUR_MASTER_HOST_NAME,$CONJUR_FOLLOWER_SERVICE_NAME"
###########################################################
